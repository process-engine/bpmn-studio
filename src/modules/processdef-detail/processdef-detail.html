<template>
  <require from="../bpmn-io/bpmn-io"></require>
  <require from="../import-process-button/import-process-button"></require>
  <require from="./processdef-detail.css"></require>

  <div if.bind="process">
    <div class="bpmn-toolbar-holder">
      <div class="bpmn-toolbar">
        <div class="action-dropdown ${startedProcessId ? 'action-dropdown-open' : ''}" ref="startButtonDropdown">
          <button disabled.bind="process.latest" click.delegate="publishDraft()" class="btn btn-primary">
            <i class="glyphicon glyphicon-tag"></i> Publish Draft
          </button>
          <button ref="startButton" disabled.bind="process.draft" click.delegate="startProcess()" class="btn btn-success">
            <i class="glyphicon glyphicon-play"></i> Start
          </button>
          <div class="action-dropdown-content">
            <div class="action-dropdown-bar action-dropdown-header">
              <h5 class="header">Process Instance
                <a href="#" title="Close" class="pull-right" click.delegate="closeProcessStartDropdown()">&times;</a>
              </h5>
              <span class="text-muted">${startedProcessId}</span>
            </div>
            <ul class="action-dropdown-list-group">
              <li class="action-dropdown-list-group-item">
                <a href="#/process/${startedProcessId}/">
                  <i class="glyphicon glyphicon-info-sign"></i> Details
                </a>
              </li>
              <li class="action-dropdown-list-group-item">
                <a href="#/process/${startedProcessId}/task">
                  <i class="glyphicon glyphicon-list-alt"></i> Tasks
                </a>
              </li>
            </ul>
          </div>
        </div>
        <a class="btn btn-primary" href="#/processdef/${process.id}/process">
          <i class="glyphicon glyphicon-tasks"></i> Processes
        </a>
        <a class="btn btn-primary" href="#/processdef/${process.id}/task">
          <i class="glyphicon glyphicon-list-alt"></i> Tasks
        </a>
        <button disabled.bind="process.latest" class="btn btn-success save-button" click.delegate="saveDiagram()">
            <i class="glyphicon glyphicon-floppy-disk"></i> Save
        </button>
        <button disabled.bind="process.draft" class="btn btn-danger" click.delegate="deleteProcess()">
          <i class="glyphicon glyphicon-trash"></i> Delete Process
        </button>
        <div class="btn-group">
          <a ref="exportButton" class="btn btn-primary export-button" click.delegate="exportBPMN()">
            <i ref="exportSpinner" class="glyphicon glyphicon-repeat fa-spin hidden"></i>
            <i class="glyphicon glyphicon-export"></i> Export Diagram
          </a>
          <a ref="exportDropdown" class="btn btn-primary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <span class="caret"></span>
            <span class="sr-only">Toggle Dropdown</span>
          </a>
          <ul class="dropdown-menu">
            <li><a href="#" click.delegate="exportBPMN()">BPMN (default)</a></li>
            <li><a href="#" click.delegate="exportSVG()">SVG</a></li>
            <li><a href="#" click.delegate="exportPNG()">PNG</a></li>
            <li><a href="#" click.delegate="exportJPEG()">JPEG</a></li>
          </ul>
        </div>
        <import-process-button desired-process-import-key.bind="process.key" callback.bind="onModdlelImported.bind($this)"></import-process-button>
        <div class="btn-group elements-workspace">
            <a class="btn btn-default dropdown-toggle" data-toggle="dropdown">
              <i class="glyphicon glyphicon-tint"></i>
            </a>
            <ul class="dropdown-menu">
              <li><a click.delegate="setColorRed()">Red</a></li>
              <li><a click.delegate="setColorBlue()">Blue</a></li>
              <li><a click.delegate="setColorGreen()">Green</a></li>
              <li><a click.delegate="setColorPurple()">Purple</a></li>
              <li><a click.delegate="setColorOrange()">Orange</a></li>
              <li><a click.delegate="setColorWhite()">White</a></li>
            </ul>
          </div>
        <div class="btn-group">
          <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
            Distribute
            <span class="caret"></span>
          </button>
          <ul class="dropdown-menu">
            <li><a click.delegate="distributeElementsHorizontal()">Horizontal</a></li>
            <li><a click.delegate="distributeElementsVertical()">Vertical</a></li>
          </ul>
        </div>
        <span if.bind="process.latest" class="processdef-detail__draft-latest--true">Latest</span>
        <span if.bind="process.draft" class="processdef-detail__draft-latest--true">Draft</span>
      </div>
    </div>
    <bpmn-io view-model.ref="bpmn" xml.bind="process.xml"></bpmn-io>
  </div>

  <div class="container" if.bind="!process">
    <h3>Process Definition not found</h3>
  </div>

</template>
